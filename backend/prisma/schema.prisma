generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Registration model - Đăng ký
model DangKy {
  id          String  @id @default(uuid())
  hoTen       String // Họ và tên (required)
  soDienThoai String // Phone (required) - encrypted
  tinhThanh   String // Province (required)
  quanHuyen   String // City/District (required)
  diaChi      String? // Address (optional)

  trangThai   TrangThai @default(CHO_XU_LY)
  nguonDangKy String    @default("landing_page")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([soDienThoai])
  @@index([trangThai])
  @@index([createdAt])
  @@map("dang_ky")
}

enum TrangThai {
  CHO_XU_LY
  DA_LIEN_HE
  THANH_CONG
  TU_CHOI
}

// Page Sections - Dynamic Layout Engine - Phần Mục Trang
model PhanMuc {
  id        String    @id @default(uuid())
  key       String    @unique // hero_main, concept_intro, etc.
  loaiBoCuc LoaiBoCuc // Layout type
  noiDung   Json // { title, subtitle, richText }
  hinhAnh   String[] // Array of image URLs
  ctaLink   String? // Optional external redirect URL
  thuTu     Int       @default(0)
  hienThi   Boolean   @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([key])
  @@index([loaiBoCuc, thuTu])
  @@map("phan_muc")
}

enum LoaiBoCuc {
  HERO_VIDEO
  HERO_IMAGE
  SPLIT_IMAGE_TEXT
  BENTO_GRID
  CAROUSEL
  MASONRY_GRID
  TEXT_ONLY
  CTA_BANNER
}

// Popup Banners - Banner Popup
model BannerPopup {
  id           String  @id @default(uuid())
  hinhAnh      String // Image URL
  duongDan     String // Redirect URL
  hoatDong     Boolean @default(true)
  doTreHienThi Int     @default(3000) // Display delay in ms
  thuTuUuTien  Int     @default(0) // Priority order

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([hoatDong, thuTuUuTien])
  @@map("banner_popup")
}

// Campaign Events - Sự Kiện
model SuKien {
  id          String    @id @default(uuid())
  tieuDe      String // Title
  moTa        String?   @db.Text // Description
  ngayBatDau  DateTime // Start date
  ngayKetThuc DateTime? // End date (optional for ongoing events)
  anhBia      String // Cover image
  boSuuTapAnh String[] // Gallery images array
  noiDung     Json? // Additional rich content
  noiBat      Boolean   @default(false) // Is featured
  hienThi     Boolean   @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([ngayBatDau])
  @@index([noiBat, hienThi])
  @@map("su_kien")
}

// Business Modules - Mô Hình Kinh Doanh (B2B)
model MoHinhKinhDoanh {
  id               String  @id @default(uuid())
  ten              String // Module name
  moTa             String  @db.Text // Description
  anhIcon          String? // Icon URL
  tiemNangLoiNhuan String? // Profit potential description
  thuTu            Int     @default(0)
  hienThi          Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([thuTu])
  @@map("mo_hinh_kinh_doanh")
}

// Partnership FAQs - Hỏi Đáp Hợp Tác (B2B)
model HoiDapHopTac {
  id      String  @id @default(uuid())
  cauHoi  String // Question
  traLoi  String  @db.Text // Answer
  thuTu   Int     @default(0)
  hienThi Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([thuTu])
  @@map("hoi_dap_hop_tac")
}

// Content Management model - Nội dung (Legacy support)
model NoiDung {
  id      String      @id @default(uuid())
  loai    LoaiNoiDung // HERO, FEATURE, FAQ, etc
  tieuDe  String
  moTa    String?     @db.Text
  noiDung Json // Flexible JSON content
  thuTu   Int         @default(0)
  hienThi Boolean     @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([loai, thuTu])
  @@map("noi_dung")
}

enum LoaiNoiDung {
  HERO
  FEATURE
  STATISTIC
  FAQ
  PARTNER
  TESTIMONIAL
}

// Settings/Config model - Cấu hình (GlobalSettings)
model CauHinh {
  id    String  @id @default(uuid())
  key   String  @unique // primary_register_url, site_name, etc.
  value Json
  moTa  String?

  @@map("cau_hinh")
}

// Admin User model - Quản trị viên
model QuanTriVien {
  id       String  @id @default(uuid())
  email    String  @unique
  matKhau  String // Hashed password
  hoTen    String
  vaiTro   VaiTro  @default(ADMIN)
  hoatDong Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("quan_tri_vien")
}

enum VaiTro {
  SUPER_ADMIN
  ADMIN
}
